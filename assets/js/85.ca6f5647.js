(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{407:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"adapter模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#adapter模式"}},[s._v("#")]),s._v(" adapter模式")]),s._v(" "),t("p",[s._v("适配模式,指的是新的接口通过适配器访问原有接口,保持尽可能少的修改变更.")]),s._v(" "),t("p",[s._v("业务场景中很少尝试,原因是大多数情况对api的调用封装只会考虑到一层,例如以api包装或者helper处理,但实际上这两类方式不一定完全符合设计约束,或者说基本不符合程序设计思路")]),s._v(" "),t("p",[s._v("可参考的实例是基于autofac-castle-dynamicProxy的castle-core-asyncInterceptor的abp封装,这里主要梳理逻辑而不是代码示例.")]),s._v(" "),t("p",[s._v("按示例代码逻辑梳理出来的调用过程:")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("adapter 入口")]),s._v(" "),t("p",[s._v("继承或实现组件接口,实现泛型注入(通常为构造函数继承重写)")])]),s._v(" "),t("li",[t("p",[s._v("adapter 调用")]),s._v(" "),t("p",[s._v("在入口组件中对核心调用过程重构.通过1个或多个适配器组织参数或者方法调用,同时注入自己的逻辑处理和自己的逻辑参数,替换或者追加")])]),s._v(" "),t("li",[t("p",[s._v("adapter 参数")]),s._v(" "),t("p",[s._v("如非必要,简单类型参数还是尽量包装,非简单类型的参数还是通过适配过程更合适")]),s._v(" "),t("p",[s._v("在适配过程中甚至可以插入新的代码逻辑函数委托")])])]),s._v(" "),t("p",[s._v("最终过程是以原组件注册-触发->进入重写的入口实现->进入adapter中的新逻辑和方法,同时传递原接口必要信息->调用adapter方法")]),s._v(" "),t("h2",{attrs:{id:"hash和md5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hash和md5"}},[s._v("#")]),s._v(" hash和md5")]),s._v(" "),t("p",[s._v("哈希算法也称摘要算法、散列算法，哈希函数的输入为一段"),t("strong",[s._v("可变长度x")]),s._v("，输出一"),t("strong",[s._v("固定长度串")]),s._v("，该串被称为"),t("strong",[s._v("x的哈希值")]),s._v("。Hash函数满足以下几个基本需求：")]),s._v(" "),t("p",[s._v("（1）输入值x为任意长度")]),s._v(" "),t("p",[s._v("（2）输出值长度固定")]),s._v(" "),t("p",[s._v("（3）单向函数，算法不可逆")]),s._v(" "),t("p",[s._v("（4）唯一性，很难找到两个不同的输入会得到相同的Hash输出值")]),s._v(" "),t("p",[s._v("md5是hashlib模块里的一个方法，是用来做加密算法的，注意他是不能解密的。")]),s._v(" "),t("h2",{attrs:{id:"signalr底板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#signalr底板"}},[s._v("#")]),s._v(" signalR底板")]),s._v(" "),t("p",[s._v("底板针对的也就是连接数量太多增加了集群负载均衡之后进行的多server同步发送，但似乎有点难以处理逻辑（指的是由自主控制的）")]),s._v(" "),t("p",[s._v("一种比较简单的做法是客户端直连数据中间件，比如MQ、Redis...")]),s._v(" "),t("p",[s._v("通常的demo中都是混合api和hub的，通信通过HubContext，这种方式似乎耦合性高而且也很难继续优化，提供的如redis底板方案最终的落地还是要考虑负载均衡")]),s._v(" "),t("p",[s._v("如果将hub-server从逻辑中拿走，可能效果更好，思路大概如下：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("客户端http请求api-server，得到hub-server的url，通过某种算法持久")])]),s._v(" "),t("li",[t("p",[s._v("客户端连接hub-server，持久化连接")])]),s._v(" "),t("li",[t("p",[s._v("api-server通过httpClient请求hub-server，传输消息")])]),s._v(" "),t("li",[t("p",[s._v("hub-server向客户端输出")])])]),s._v(" "),t("h2",{attrs:{id:"自包含部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自包含部署"}},[s._v("#")]),s._v(" 自包含部署")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/core/deploying/deploy-with-cli",target:"_blank",rel:"noopener noreferrer"}},[s._v(".NET CLI 发布 .NET 应用"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("dotnet publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" Release "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" win10-x64 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" %outPut% --self-contained "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\ndotnet publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" Release "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" linux-x64 --self-contained "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"system-drawing验证码the-type-initializer-for-gdip-threw-an-exception"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#system-drawing验证码the-type-initializer-for-gdip-threw-an-exception"}},[s._v("#")]),s._v(" System.Drawing验证码The type initializer for 'Gdip' threw an exception.")]),s._v(" "),t("p",[s._v("Linux部署时由于System.Drawing.Common的路线问题会出现如上错误，这个错误的官方释疑：")]),s._v(" "),t("p",[s._v("https://learn.microsoft.com/zh-cn/dotnet/core/compatibility/core-libraries/6.0/system-drawing-common-windows-only")]),s._v(" "),t("p",[s._v("补充阅读 https://devblogs.microsoft.com/dotnet/net-core-image-processing/")]),s._v(" "),t("p",[s._v("目前可以查询到有些包依赖于此，比如EPPlus的较旧版本。")]),s._v(" "),t("p",[s._v("目前比较合适的nuget：https://gitee.com/pojianbing/lazy-captcha")]),s._v(" "),t("p",[s._v("imageSharp许可证有问题，SkiaSharp也许是最合适目前的（在Linux上可能需要再依赖于官方提供的其他依赖）")]),s._v(" "),t("h2",{attrs:{id:"c-使用python"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#c-使用python"}},[s._v("#")]),s._v(" C#使用PYTHON")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("C++的动态库链接(套个中间层)")])]),s._v(" "),t("li",[t("p",[s._v("IronPython")]),s._v(" "),t("p",[s._v("https://github.com/IronLanguages/ironpython3")]),s._v(" "),t("p",[s._v("https://github.com/IronLanguages/ironpython3/blob/master/Documentation/package-compatibility.md")])]),s._v(" "),t("li",[t("p",[s._v("Pythonnet")]),s._v(" "),t("p",[s._v("https://github.com/pythonnet/pythonnet")])])]),s._v(" "),t("h2",{attrs:{id:"nginx之forward头"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx之forward头"}},[s._v("#")]),s._v(" Nginx之Forward头")]),s._v(" "),t("p",[s._v("http规范里对请求头的定义、兼容废弃等标志的很清楚, 按需再查吧.")]),s._v(" "),t("p",[s._v("这里针对的是经过Nginx转发之后的Scheme、Host等进行标识和转存, NetCore中已有相关集成")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("proxy_set_header X-Forwarded-Host $the_host/onlyoffice;\nproxy_set_header X-Forwarded-Proto $the_scheme;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n")])])]),t("h2",{attrs:{id:"opengauss中pgsql驱动问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#opengauss中pgsql驱动问题"}},[s._v("#")]),s._v(" OPENGAUSS中PGSQL驱动问题")]),s._v(" "),t("p",[s._v("在ORACLE迁移OPENGAUSS时，NVARCHAR2的类型同样迁移，但OPENGAUSS使用的是PGSQL的连接库，而PGSQL中是不存在此类型的。")]),s._v(" "),t("p",[s._v("在JAVA中，通过JDBC正常可以通过查询语句得到ResultSet，而在Net中，报错‘System.Object’‘nvarchar2’....")]),s._v(" "),t("p",[s._v("https://stackoverflow.com/questions/24014147/how-to-convert-string-to-unicode-using-postgresql/24015093#24015093")]),s._v(" "),t("h2",{attrs:{id:"jwt字段名-userid写在-sub-字段-认证中间件失效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt字段名-userid写在-sub-字段-认证中间件失效"}},[s._v("#")]),s._v(" JWT字段名---userid写在'sub'字段,认证中间件失效?")]),s._v(" "),t("p",[s._v("sub 字段作为唯一标识符在各个方面都没有问题,,,微软为什么要强制mapping很长一串的标准值而不是直接的字符 ???")]),s._v(" "),t("h2",{attrs:{id:"apicontroller标注-自动模型验证且不经过模型绑定检查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apicontroller标注-自动模型验证且不经过模型绑定检查"}},[s._v("#")]),s._v(" ApiController标注--自动模型验证且不经过模型绑定检查")]),s._v(" "),t("p",[s._v("如题,这种问题有点二.")]),s._v(" "),t("p",[s._v("see https://learn.microsoft.com/zh-cn/aspnet/core/web-api/?view=aspnetcore-9.0#apicontroller-attribute")]),s._v(" "),t("p",[s._v("see https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.aspnetcore.mvc.apibehavioroptions?view=aspnetcore-9.0")]),s._v(" "),t("h2",{attrs:{id:"mvc项目、webapi项目的不同依赖和路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mvc项目、webapi项目的不同依赖和路由"}},[s._v("#")]),s._v(" MVC项目、WebApi项目的不同依赖和路由")]),s._v(" "),t("p",[s._v("依赖阶段比较好理解,命名比较清楚,通常会有如下:")]),s._v(" "),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s._v("IMvcBuilder")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IServiceCollection")]),s._v(" services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ArgumentNullException"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ThrowIfNull")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" builder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersCore")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("MvcBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PartManager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s._v("IMvcBuilder")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersWithViews")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IServiceCollection")]),s._v(" services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ArgumentNullException"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ThrowIfNull")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" builder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersWithViewsCore")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("MvcBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PartManager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s._v("IMvcCoreBuilder")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersWithViewsCore")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IServiceCollection")]),s._v(" services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" builder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersCore")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddViews")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddRazorViewEngine")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddCacheTagHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddTagHelpersFrameworkParts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PartManager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s._v("IMvcBuilder")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddMvc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IServiceCollection")]),s._v(" services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ArgumentNullException"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ThrowIfNull")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddControllersWithViews")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" services"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddRazorPages")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("在路由阶段有点迷惑性,通常会有约定路由和特性路由")]),s._v(" "),t("p",[t("strong",[s._v("MapControllerRoute")])]),s._v(" "),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[s._v("endpoints"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("MapControllerRoute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token named-parameter punctuation"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token named-parameter punctuation"}},[s._v("pattern")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{controller=Home}/{action=index}/{id?}"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("MapDefaultControllerRoute")]),s._v(",正是上面约定路由的默认样例")]),s._v(" "),t("p",[t("strong",[s._v("MapControllers")]),s._v(",不对约定路由做任何假设，也就是不使用约定路由，依赖用户的"),t("strong",[s._v("特性路由")])]),s._v(" "),t("h2",{attrs:{id:"uri和url编码-escapedatastring、escapeuristring和urlencode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uri和url编码-escapedatastring、escapeuristring和urlencode"}},[s._v("#")]),s._v(" URI和URL编码：EscapeDataString、EscapeUriString和UrlEncode")]),s._v(" "),t("p",[t("code",[s._v("Uri.EscapeDataString")])]),s._v(" "),t("p",[s._v("​\t用于对URI的数据部分进行编码,将所有非字母数字字符（包括空格）转换为其百分号编码形式")]),s._v(" "),t("p",[s._v("​\t和JS中的"),t("code",[s._v("encodeURIComponent")]),s._v("一致")]),s._v(" "),t("p",[t("code",[s._v("Uri.EscapeUriString")])]),s._v(" "),t("p",[s._v("​\t对整个URI进行编码,保留URI中的保留字符（如"),t("code",[s._v("?")]),s._v("、"),t("code",[s._v("/")]),s._v("、"),t("code",[s._v("#")]),s._v("等），不对它们进行编码")]),s._v(" "),t("p",[s._v("​\t"),t("strong",[s._v("和浏览器行为一致,但它被标记为弃用了")])]),s._v(" "),t("p",[s._v("​\t和JS中的"),t("code",[s._v("encodeURI")]),s._v("一致")]),s._v(" "),t("p",[s._v("encodeURIComponent(proxy.$base64.encode(encodeURI(row.fileUrl)));")]),s._v(" "),t("h2",{attrs:{id:"请求处理管道图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#请求处理管道图"}},[s._v("#")]),s._v(" 请求处理管道图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.gitcode.com/qq_36179938/images/raw/main/900440-20230430112047263-366313603.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"transactionscope"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transactionscope"}},[s._v("#")]),s._v(" TransactionScope")]),s._v(" "),t("p",[s._v("select for update")]),s._v(" "),t("p",[s._v("select with tablelock")]),s._v(" "),t("p",[s._v("select with nolock")]),s._v(" "),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" scope "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("TransactionScope")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TransactionScopeOption"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Suppress"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" scope "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("TransactionScope")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n     TransactionScopeOption"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("TransactionOptions")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" IsolationLevel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" IsolationLevel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReadUncommitted "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);