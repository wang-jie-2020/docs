(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{492:function(s,a,t){"use strict";t.r(a);var e=t(5),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("[toc]")]),s._v(" "),a("p",[s._v("linux-release: https://download.redis.io/releases/*")]),s._v(" "),a("h2",{attrs:{id:"tar包部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tar包部署"}},[s._v("#")]),s._v(" TAR包部署")]),s._v(" "),a("h3",{attrs:{id:"_1-编译依赖安装-也许需要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-编译依赖安装-也许需要"}},[s._v("#")]),s._v(" (1) 编译依赖安装(也许需要)")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新软件包列表（可选，但推荐）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum update\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装gcc编译器、c++库及tcl（用于Redis测试）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc gcc-c++ tcl\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_2-获取并解压redis源码包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取并解压redis源码包"}},[s._v("#")]),s._v(" (2) 获取并解压Redis源码包")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用wget下载（以Redis 6.0.20为例，请替换为所需版本）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-6.0.20.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压源码包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-xzvf")]),s._v(" redis-6.0.20.tar.gz\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -xzf filename.tar.gz -C /path/to/target/directory")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入解压后的目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-6.0.20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_3-编译与安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-编译与安装redis"}},[s._v("#")]),s._v(" (3) 编译与安装Redis")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到默认路径（通常是 /usr/local/bin）")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/redis-6.0.20 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到自定义目录 /usr/local/redis-6.0.20")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("使用自定义目录时，后续操作中需要使用该目录下的二进制文件完整路径，例如 "),a("code",[s._v("/usr/local/redis-6.0.20/bin/redis-server")])]),s._v(" "),a("h3",{attrs:{id:"_4-配置运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置运行"}},[s._v("#")]),s._v(" (4) 配置运行")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 假设当前仍在redis源码目录中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/redis \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" redis.conf /etc/redis/redis.conf \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("设置为守护进程")]),s._v("：daemonize yes")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("redis-server /etc/redis/redis.conf\n\nredis-cli -a 'password'\t# ping -> pong\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_5-生产环境进阶设置-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-生产环境进阶设置-可选"}},[s._v("#")]),s._v(" (5) 生产环境进阶设置 (可选)")]),s._v(" "),a("p",[s._v("对于生产环境，你可能还需要考虑：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("配置为系统服务")]),s._v("：可以参考 "),a("code",[s._v("redis-x.x.x/utils")]),s._v(" 目录下的 "),a("code",[s._v("redis_init_script")]),s._v("，将其修改后放入 "),a("code",[s._v("/etc/init.d/")]),s._v(" 并设置为开机自启 。")])]),s._v(" "),a("h3",{attrs:{id:"_6-通过进程信息查找"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-通过进程信息查找"}},[s._v("#")]),s._v(" (6) 通过进程信息查找")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" redis\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" /proc/1234/cwd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("Redis进程"),a("strong",[s._v("当前的工作目录")]),s._v("。"),a("code",[s._v("/proc")]),s._v("文件系统也会提供其他进程信息，例如"),a("code",[s._v("exe")]),s._v("符号链接指向执行程序的"),a("strong",[s._v("绝对路径")]),s._v("。")]),s._v(" "),a("ul",[a("li",[s._v("要查找"),a("strong",[s._v("正在运行的Redis进程的当前目录")]),s._v("，最直接的方法是结合"),a("code",[s._v("ps")]),s._v("和"),a("code",[s._v("/proc/cwd")]),s._v("。")]),s._v(" "),a("li",[s._v("要查找"),a("strong",[s._v("Redis的数据目录")]),s._v("，使用"),a("code",[s._v("redis-cli CONFIG GET dir")]),s._v("命令通常最准确")])]),s._v(" "),a("h2",{attrs:{id:"迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#迁移"}},[s._v("#")]),s._v(" 迁移")]),s._v(" "),a("p",[s._v("RDB或AOF迁移, rdb、aof cp到新目录再起即可")]),s._v(" "),a("h3",{attrs:{id:"在线数据还原-不停服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在线数据还原-不停服务"}},[s._v("#")]),s._v(" 在线数据还原(不停服务)")]),s._v(" "),a("p",[s._v("注意 -> 未尝试 !!!")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果备份是RDB格式，可以启动一个临时Redis实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动临时实例")]),s._v("\nredis-server "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dbfilename")]),s._v(" temp.rdb\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在另一个终端连接并导出数据")]),s._v("\nredis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pipe")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /path/to/backup/dump.rdb\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者使用BGSAVE创建新的RDB文件")]),s._v("\nredis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v(" BGSAVE\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);