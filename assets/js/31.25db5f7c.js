(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{360:function(t,e,a){"use strict";a.r(e);var s=a(5),l=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("大小写敏感问题:")]),t._v(" "),e("ul",[e("li",[t._v("SQL Server默认不区分大小写，但可以通过设置排序规则精确控制。")])]),t._v(" "),e("p",[t._v("字符集校对规则:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("_CI")]),t._v("：Case-Insensitive，不区分大小写。")]),t._v(" "),e("li",[e("strong",[t._v("_CS")]),t._v("：Case-Sensitive，区分大小写。")])]),t._v(" "),e("h2",{attrs:{id:"函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[t._v("#")]),t._v(" 函数")]),t._v(" "),e("h3",{attrs:{id:"一、字符串函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、字符串函数"}},[t._v("#")]),t._v(" "),e("strong",[t._v("一、字符串函数")])]),t._v(" "),e("p",[t._v("用于处理文本数据，如截取、连接、查找和替换。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("函数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("功能描述")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("LEN(string)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回字符串长度（忽略尾部空格）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("LEN('Hello')")]),t._v(" → 5")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SUBSTRING(expr, start, length)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("从指定位置截取子串（start从1开始）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SUBSTRING('SQL', 2, 2)")]),t._v(" → 'QL'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONCAT(str1, str2, ...)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("连接多个字符串（自动处理NULL）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONCAT('A', NULL, 'B')")]),t._v(" → 'AB'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CHARINDEX(substr, string)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("查找子串首次出现的位置，未找到则返回0。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CHARINDEX('L', 'HELLO')")]),t._v(" → 3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("REPLACE(string, old, new)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("替换字符串中所有出现的指定子串。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("REPLACE('A-B-C', '-', '')")]),t._v(" → 'ABC'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("UPPER(string) / LOWER(string)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("将字符串转换为全大写/全小写。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("UPPER('sql')")]),t._v(" → 'SQL'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("LTRIM(string) / RTRIM(string)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("去除字符串左侧/右侧的空格。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("LTRIM(' test')")]),t._v(" → 'test'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("REVERSE(char_expr)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("反转字符串。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("REVERSE('123')")]),t._v(" → '321'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("STUFF(char_expr1, start, length, char_expr2)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("删除指定长度的字符，并在该位置插入新字符串。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("STUFF('ABCD', 2, 2, 'XY')")]),t._v(" → 'AXYD'")])])])]),t._v(" "),e("h3",{attrs:{id:"二、日期和时间函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、日期和时间函数"}},[t._v("#")]),t._v(" "),e("strong",[t._v("二、日期和时间函数")])]),t._v(" "),e("p",[t._v("用于获取、计算和格式化日期时间。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("函数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("功能描述")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("GETDATE()")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回当前系统日期和时间（"),e("code",[t._v("datetime")]),t._v("类型）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("GETDATE()")]),t._v(" → "),e("code",[t._v("2023-12-09 10:30:00.123")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEADD(datepart, number, date)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("为日期添加一个时间间隔（如DAY, MONTH, YEAR）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEADD(DAY, 5, '2023-01-01')")]),t._v(" → "),e("code",[t._v("2023-01-06")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEDIFF(datepart, startdate, enddate)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回两个日期之间的时间间隔。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEDIFF(MONTH, '2023-01', '2023-03')")]),t._v(" → 2")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEPART(datepart, date)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回日期的指定部分（如年、月、日）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATEPART(YEAR, '2023-12-09')")]),t._v(" → 2023")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATENAME(datepart, date)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以字符串形式返回日期的指定部分（如星期几）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DATENAME(WEEKDAY, '2023-12-09')")]),t._v(" → 'Saturday'")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("YEAR(date) / MONTH(date) / DAY(date)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回日期的年份/月份/日。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("YEAR('2023-12-09')")]),t._v(" → 2023")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("EOMONTH(date)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回指定日期所在月份的最后一天。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("EOMONTH('2023-02-01')")]),t._v(" → "),e("code",[t._v("2023-02-28")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONVERT(data_type, date, style)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("将日期转换为指定样式的字符串。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONVERT(VARCHAR, GETDATE(), 23)")]),t._v(" → '2023-12-09'")])])])]),t._v(" "),e("h3",{attrs:{id:"三、数学函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、数学函数"}},[t._v("#")]),t._v(" "),e("strong",[t._v("三、数学函数")])]),t._v(" "),e("p",[t._v("用于执行数值计算。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("函数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("功能描述")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ABS(numeric_expr)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回数值的绝对值。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ABS(-10.5)")]),t._v(" → 10.5")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ROUND(numeric_expr, length)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("将数值四舍五入到指定精度。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ROUND(3.1415, 2)")]),t._v(" → 3.14")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CEILING(numeric_expr)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("向上取整，返回大于等于该数的最小整数。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CEILING(3.2)")]),t._v(" → 4")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("FLOOR(numeric_expr)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("向下取整，返回小于等于该数的最大整数。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("FLOOR(3.9)")]),t._v(" → 3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("POWER(float_expr, y)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回指定数值的幂。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("POWER(2, 3)")]),t._v(" → 8")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SQRT(float_expr)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回数值的平方根。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SQRT(9)")]),t._v(" → 3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("RAND([seed])")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回一个0到1之间的随机浮点数（可指定种子）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("RAND()")]),t._v(" → 0.7632")])])])]),t._v(" "),e("h3",{attrs:{id:"四、类型转换函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、类型转换函数"}},[t._v("#")]),t._v(" 四、类型转换函数")]),t._v(" "),e("p",[t._v("用于转换数据类型。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("函数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("功能描述")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CAST(expression AS data_type)")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("将表达式显式转换为另一种数据类型。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CAST('123' AS INT)")]),t._v(" → 123")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONVERT(data_type, expression [, style])")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("转换数据类型，常用于日期/时间的格式化（"),e("code",[t._v("style")]),t._v("参数）。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CONVERT(VARCHAR, GETDATE(), 112)")]),t._v(" → '20231209'")])])])]),t._v(" "),e("h2",{attrs:{id:"实践问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实践问题"}},[t._v("#")]),t._v(" 实践问题")]),t._v(" "),e("h3",{attrs:{id:"自增id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自增id"}},[t._v("#")]),t._v(" 自增ID")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" SCOPE_IDENTITY"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--返回插入到同一作用域中的 IDENTITY 列内的最后一个 IDENTITY 值。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" @"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@IDENTITY")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--返回插入到当前会话中任何作用域内的最后一个 IDENTITY 列值")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("一个作用域就是一个模块——存储过程、触发器、函数或批处理。因此，如果两个语句处于同一个存储过程、函数或批处理中，则它们位于相同的作用域中。")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" IDENT_CURRENT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TbName'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--不受作用域和会话的限制，而受限于指定的表。")]),t._v("\nIDENT_CURRENT 返回为任何会话和作用域中的特定表所生成的值。\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("对于马上使用的刚才插入的新记录ID用SCOPE_IDENTITY()是最合适的;")]),t._v(" "),e("p",[t._v("对于想要得到一系列的操作中最后得到的那个自增的ID最好用@@IDENTITY;")]),t._v(" "),e("p",[t._v("对于想要得到一个表中的最后一个插入操作所产生的ID的最好用IDENT_CURRENT('TBName');")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DECLARE")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@TMP_ID")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),t._v("  \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@TMP_ID")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("   IDENT_CURRENT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BID_EvaluateItem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@TMP_ID")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@TMP_ID")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--其它的操作  ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])])])}),[],!1,null,null,null);e.default=l.exports}}]);