







### settings

运行时的全局模式, 其中一些是全局默认值可以在XML中重写

| name                     | desc                                                         |
| ------------------------ | ------------------------------------------------------------ |
| useGeneratedKeys         | 允许 JDBC 支持自动生成主键，需要数据库驱动支持。如果设置为 true，将强制使用自动生成主键。 |
| mapUnderscoreToCamelCase | 实现从经典数据库列名 A_COLUMN 到驼峰式经典 Java 属性名 aColumn 的自动映射。 |
| defaultExecutorType      | 配置默认执行器。SIMPLE 执行器不执行任何特殊操作。REUSE 执行器重用预处理语句。BATCH 执行器重用语句并批量处理更新。默认SIMPLE。 |
| defaultEnumTypeHandler   | 指定 Enum 使用的默认 `TypeHandler` 。默认org.apache.ibatis.type.EnumTypeHandler。 |
| logImpl                  | 指定 MyBatis 所用日志的具体实现，未指定时将自动查找。        |
| vfsImpl                  | 指定 VFS 的实现                                              |

### typeAliases 类型别名

它仅与 XML 配置相关，其存在的唯一目的是为了减少重复输入完全限定类名。通常是在配置时指定包名自动发现：mybatis.typeAliasesPackage=xxx.domain/entity

### typeHandlers 类型处理器

java type 和 jdbc type的关系处理，不太需要关注，重写时实现或扩展

 `org.apache.ibatis.type.TypeHandler`、`org.apache.ibatis.type.BaseTypeHandler`

### Handling Enums 处理枚举

提供了两种处理 EnumTypeHandler（name） 或 EnumOrdinalTypeHandler（ordinal）

（1）上述也许不满足场景， 比如存储状态整型值（直接忽略Ordinal吧）

（2）显示XML配置

```XML
<resultMap>
    <result column="roundingMode" property="roundingMode" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/>
</resultMap>

<insert id="insert2">
    insert into users2 (roundingMode) values (
     #{roundingMode, typeHandler=org.apache.ibatis.type.EnumTypeHandler}
    )
</insert>
```

### plugins

MyBatis 允许你在映射语句执行过程中的某一点进行拦截调用。默认情况下，MyBatis 允许使用插件来拦截的方法调用包括：

- Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)
- ParameterHandler (getParameterObject, setParameters)
- ResultSetHandler (handleResultSets, handleOutputParameters)
- StatementHandler (prepare, parameterize, batch, update, query)



## 映射器 XML 文件

### XML元素

（insert and update）useGeneratedKeys

（insert and update）keyProperty

（insert and update）keyColumn（如PGSQL 第一列非Id）

```XML
<insert id="insertAuthor" useGeneratedKeys="true"
    keyProperty="id">
  insert into Author (username,password,email,bio)
  values (#{username},#{password},#{email},#{bio})
</insert>
```

### 动态SQL

- if
- choose (when, otherwise)
- trim (where, set)
- foreach

```xml
<if test="name != null">
</if>

 <choose>
     <when test="title != null">...</when>
     <otherwise>...</otherwise>
</choose>

<foreach item="item" index="index" collection="list"
         open="ID in (" separator="," close=")" nullable="true">
    #{item}
</foreach>
```