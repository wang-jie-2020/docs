## 记录访问控制讨论与思路

访问控制的权限模型包含三个核心对象：

- 资源：特定资源如 `books:123`、多个资源如 `books:123,books:124`，或一类资源如 `books:*`

- 操作：特定操作如 `books:edit`、多个操作如 `books:read,books:edit`，或一类操作如 `books:*`

- 主体：用户或角色

校验输出即权限效用：允许（ALLOW）或拒绝（DENY）

## 基于角色的访问控制(RBAC)

> 基于角色的访问控制（Role-based access control，简称 RBAC），指的是通过用户的角色（Role）赋予其相关权限，这实现了细粒度的访问控制，并提供了一个相比直接授予单个用户权限，更简单、可控的管理方式。

> 当使用 RBAC 时，通过分析系统用户的实际情况，基于共同的职责和需求，将他们分配给不同的角色。然后可以授予每个用户一个或多个角色，每个角色具有一个或多个权限，这种 **用户-角色**、**角色-权限** 间的关系，让我们可以不用再单独管理单个用户，用户从具备的角色里面继承所需的权限，从而使得用户赋权这件事变得更加简单。

> 举一个公司内所有在职员工具备登录公司邮箱的权限的场景，如果应用 RBAC，就可以赋予所有在职员工 employee 角色，employee 角色具备 email:login 权限，如此所有员工就具备了登录公司邮箱的权限。如果有员工离职，只需要将其移出 employee 角色，而不需单独收回权限。本质上，一个角色（Role）就是一组权限（Permission）的集合。使用角色添加、删除、调整权限，相比单独赋予单个用户权限更加简单。当你的用户基数不断增长时，角色会变得尤为有用。

> 在规划访问控制策略时，最佳实践是给予用户完成工作必须的最小权限。

当前的WEB框架中通常采用的RBAC1（嵌套的角色父子结构）的方案，最终的呈现近似组织结构

RBAC不能满足的场景包括：

1. 不能指定具体的资源，不能按照资源属性定制比如基于TAG的访问管理（当然经过编码也不是完全不能）
2. 正向控制，即只能表达允许而不能表达拒绝
3. 复杂的控制可能导致角色爆炸

简单总结就是灵活性、扩展性不足

## 基于策略的访问控制(PBAC)

> 基于策略的访问控制（PBAC）是一种安全策略，它允许管理员设置不同的访问策略，用于控制用户或计算机在网络上的访问权限。策略可以添加，删除，归档或修改，使用户能够访问必要的资源，而不会获得非授权的访问权限。

> PBAC基于用户角色来创建策略。用户角色是指为不同用户分配的职能。根据不同的角色，系统管理员可以按照用户的角色为其分配最佳的权限，以增强安全性。系统管理员可以在其网络中设置不同的策略，从而限制用户访问特定的网盘，文件夹或资源。

> 使用PBAC可以限制用户访问某些数据，从而保护网络中的重要资源免受不当访问和滥用。它还可以阻止未授权的用户访问其他非系统内的重要信息。此外，它还可以提供可追溯性，这样就可以追溯用户和特定活动之间的联系。

概念略，就是资源、操作、主题、结果的结构树，以JSON配置（适配复杂场景）

```json
{
  "statements": [
    {
      "resource": "books:123",
      "action": ["books:edit"],
      "effect": "ALLOW",
      "Principal": {
          "AWS": "user:Dave"
      },
    },
    {
      "resource": "books:123",
      "action": ["books:delete"],
      "effect": "DENY",
      "Principal": {
          "AWS": "user:*"
      },
    }
  ]
}
```

以JSON描述访问控制带来的力量必须要付出时间代价